{% extends 'base.html' %}
{% block title %}记账簿详情{% endblock %}
{% block preload_js %}
<script tpye="text/javascript">
$(function(){

    $("input[name='remove']").click(function(){
        var ids = "";
        $("input:checked[name='checkItem']").each(function(){
            ids += $(this).val()+",";
        });
        if (ids == "")
        {
            alert("请至少选择一项！");
            return;
        }
        var flag = confirm("您确定要删除这些条目吗?");
        if (flag)
            location.href="/books/" + {{form.id}} + "/deleteItems/?ids="+ids;
    });

    $("input[name='checkAll']").click(function(){
            $("input[name='checkItem']").attr("checked", this.checked);
    });
}
);
</script>
{% endblock %}
{% block content %}
<div>名称: {{form.name}}</div>
<div>描述:{{form.description}}</div>
<div>所属人:{{form.create_by}}</div>
<div>创建时间:{{form.create_date}}</div>
<div>相关人员:{%for contactBook in form.contact_book_set.all%}{{contactBook.contact.name}}&nbsp;&nbsp;{%endfor%}</div>

<div><a href="{%url 'addItem' form.id %}">添加条目</a></div><input name="remove" type="button" value="删除">
<table align="center" border='1'>
    <tr><th><input type="checkbox" name="checkAll">全选</th><th>标题</th><th>描述</th><th>金额</th><th>类型</th><th>涉及人员</th></tr>
    {%for bill in form.bill_set.all%}
    <tr style="{%if bill.amount > 0%} color:green; {%else%} color:red; {%endif%}"><td><input type="checkbox" name="checkItem" value="{{bill.id}}"></td><td>{{bill.title}}</td><td>{{bill.description}}</td><td>{{bill.amount}}</td>{%if bill.amount > 0%}<td>收入</td>{%else%}<td>支出</td>{%endif%}<td>
    {%for billItem in bill.bill_item_set.all%}
        {{billItem.contact.name}}: {{billItem.amount}},
    {%endfor%}
    </td></tr>
    {%endfor%}
</table>


{% endblock %}
