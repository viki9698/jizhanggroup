{% extends 'base.html' %}
{% block title %}添加数据项{% endblock %}
{% block preload_js %}
<script tpye="text/javascript">
$(function(){


    $("input[name='save']").click(function(){
        var ids = "";
        $("input:checked[name='contact']").each(function(){
            ids += $(this).val()+",";
        });
        if (ids == "")
        {
            alert("请至少选择一项涉及人员！");
            return false;
        }
        $("input[name='contactIds']").val(ids);
    });
}
);
</script>
{% endblock %}
{% block subTitle %}新建记录{% endblock %}

{% block content %}
{% if form.errors %}
    <p style="color:red;"
        Please correct the form
    </p>
{% endif %}
<form  method="post" action="">{% csrf_token %}

    <table>
        {{form.as_table}}
<tr><th><label for="id_contact_0">相关人员:</label></th><td><ul>
{%for contact in contacts%}
<li><label for="id_contact_{{ forloop.counter }}"><input id="id_contact_{{ forloop.counter }}" name="contact" type="checkbox" value="{{contact.id}}" />{{contact.name}}
<input type="text" name="subCount_{{contact.id}}" size="8px"></label></li>
{%endfor%}
</ul></td></tr>
    </table>
    <input type="submit" name="save" value="添加">
<input type="hidden" name="contactIds">
</form>


{% endblock %}

